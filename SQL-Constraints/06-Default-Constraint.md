# DEFAULT constraint

How to provide a default value for a column.

Hi there! In this part of the course, we're going to tackle yet another constraint type – `DEFAULT`. As the name suggests, `DEFAULT` allows us to provide default values for our columns.

Are you ready to learn more?

## DEFAULT - Introduction

Let's get started! Take a look at the example:

```sql
CREATE TABLE card_game (
  id integer GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name varchar(32) UNIQUE NOT NULL,
  genre varchar(32),
  min_players integer DEFAULT 2,
  min_time integer DEFAULT 60,
  cooperation boolean DEFAULT FALSE
);
```

In the example above, there are several instances of `DEFAULT`. Let's take a look at one of them:

```sql
min_players integer DEFAULT 2
```

As you might expect, the constraint tells the database what the default value should be. In this case, if the user does not provide any value for the `min_players` column, the database will insert the default value `2`.

### Exercise

Run the template from the example. We're going to work with the new table `card_game`.

```sql
CREATE TABLE card_game (
  id integer GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name varchar(32) UNIQUE NOT NULL,
  genre varchar(32),
  min_players integer DEFAULT 2,
  min_time integer DEFAULT 60,
  cooperation boolean DEFAULT FALSE
);
```

## DEFAULT – Inserting data

Okay. Now, let's take a closer look at how rows are added.

### Exercise

Insert a new game into the `card_game` table and specify only the `name` `'Citadels'` and the `genre` `'historical'`. What do you think will happen? Check out the resulting row.

```sql
INSERT INTO card_game (name, genre)
VALUES ('Citadels', 'historical');
```

Output:

| id | name | genre | min_players | min_time | cooperation |
| --- | --- | --- | --- | --- | --- |
| 1 | Blitz | social | 2 | 10 | f |
| 2 | Cheat | party | 2 | 30 | f |
| 3 | Fan Tan | gambling | 3 | 30 | f |
| 4 | Citadels | historical | 2 | 60 | f |

## DEFAULT – NULL values

Great! As you can see, the database inserted the values itself. But what will happen if we force `NULL` values instead?

### Exercise

Let's try to insert another `card_game`. The `name` is `'Three Dragon Ante'`, and the `genre` is `'fantasy'`. As for the columns `min_players`, `min_time` and `cooperation`, force a `NULL` value by providing it in the `INSERT` statement.

Then look at the inserted row. What happened?

```sql
INSERT INTO card_game (name, genre, min_players, min_time, cooperation)
VALUES ('Three Dragon Ante', 'fantasy', NULL, NULL, NULL);
```

Output:

| id | name | genre | min_players | min_time | cooperation |
| --- | --- | --- | --- | --- | --- |
| 1 | Blitz | social | 2 | 10 | f |
| 2 | Cheat | party | 2 | 30 | f |
| 3 | Fan Tan | gambling | 3 | 30 | f |
| 4 | Citadels | historical | 2 | 60 | f |
| 5 | Three Dragon Ante | fantasy | null | null | null |

## DEFAULT – Creating tables

Well, the values have been set to `NULL` because this is what the user wanted. As you can see, the `DEFAULT` constraint does not prevent `NULL` values in the given column. It only provides a value when the user does not mention the specific column in their instructions.

### Exercise

Using the template as a guide, create the `card_game` table on your own. Add these `DEFAULT` constraints: the value `2` for `min_players`, the value `60` for `min_time`, and `FALSE` for `cooperation`. Give it a try!

```sql
CREATE TABLE card_game (
  id integer GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name varchar(32) UNIQUE NOT NULL,
  genre varchar(32),
  min_players integer DEFAULT 2,
  min_time integer DEFAULT 60,
  cooperation boolean DEFAULT FALSE
);
```

## DEFAULT and sequences – 1

Excellent! Now we have a small surprise for you. Do you remember sequences? We can actually link them to columns – let's try it! We'll use the `DEFAULT` constraint. Here it is with PostgreSQL syntax:

```sql
CREATE TABLE board_game (
  id integer DEFAULT nextval('my_sequence') PRIMARY KEY
);
```

Here is the standard SQL syntax:

```sql
CREATE TABLE board_game (
  id integer DEFAULT NEXT VALUE FOR my_sequence PRIMARY KEY
);
```

Not too complicated, is it?

### Exercise

We'll build a `DEFAULT` together with a sequence. First, let's create a sequence. A sequence with the name `my_sequence` which starts at `10` and adds `2` each time would look like this:

```sql
CREATE SEQUENCE my_sequence
START WITH 10
INCREMENT BY 2;
```

Your job is to create a sequence called `id_seq`, which starts at `1` and increments by `1`.

```sql
CREATE SEQUENCE id_seq
START WITH 1
INCREMENT BY 1;
```

## DEFAULT and sequences – 2

Good! The first step is done. Let's proceed.

### Exercise

To get the next value of the sequence `my_sequence` in PostgreSQL we use the expression:

```sql
nextval('my_sequence')
```

Now, change the template we provided. We don't want the `DEFAULT` value of `id` to be `1`. Replace it with the next value of the sequence `id_seq`.

Remember that the standard SQL syntax is a little different:

```sql
NEXT VALUE FOR my_sequence
```

In this course we use the PostgreSQL syntax.

```sql
CREATE TABLE card_game (
  id integer DEFAULT nextval('id_seq'),
  name varchar(32) UNIQUE NOT NULL,
  genre varchar(32),
  min_players integer,
  min_time integer,
  cooperation boolean
);
```

## DEFAULT and sequences – 3

Okay! We've got our sequence associated with our column `id`. Let's see how it works.

### Exercise

Take your time and add a few rows without specifying the `id` column. Observe how the `id` value is generated by our sequence.

```sql
INSERT INTO card_game (name, genre, min_players, min_time, cooperation)
VALUES ('Three Dragon Ante', 'fantasy', NULL, NULL, NULL);
```

## Adding a default value for an existing column

Very well done! Now, let's take a look at how we can add a `DEFAULT` constraint to an existing table. The table looks like this:

```sql
CREATE TABLE therapist (
  id integer PRIMARY KEY,
  full_name varchar(32) DEFAULT 'anonymous',
  price decimal(5, 2),
  location varchar(32) DEFAULT 'unknown'
);
```

We want to add a default value for the `price` column. To do so, we can write:

```sql
ALTER TABLE therapist
ALTER COLUMN price SET DEFAULT 60.00;
```

The code above will add a default value of `60.00` to the `price` column in the `therapist` table.

### Exercise

A furniture store has the following table to keep track of the desks they offer:

```sql
CREATE TABLE desk (
  id integer PRIMARY KEY,
  model_name varchar(32),
  price decimal(6, 2) DEFAULT 304.91,
  is_customizable boolean
);
```

Your task is to add a default value of `FALSE` to the `is_customizable` column.

```sql
ALTER TABLE desk
ALTER COLUMN is_customizable SET DEFAULT FALSE;
```

## Removing a default value from an existing column

Perfect! On the other hand, we can also get rid of a default value. Our table definition looks the same now:

```sql
CREATE TABLE therapist (
  id integer PRIMARY KEY,
  full_name varchar(32) DEFAULT 'anonymous',
  price decimal(5, 2),
  location varchar(32) DEFAULT 'unknown'
);
```

Let's say we want to get rid of the default value for `full_name`:

```sql
ALTER TABLE therapist
ALTER COLUMN full_name DROP DEFAULT;
```

The code above removes the default value from the `full_name` column. Note that we don't need to know what the default value is – we simply tell the database to `DROP DEFAULT`.

### Exercise

You are again given the same table, desk:

```sql
CREATE TABLE desk (
  id integer PRIMARY KEY,
  model_name varchar(32),
  price decimal(6, 2) DEFAULT 304.91,
  is_customizable boolean
);
```

Your task now is to get rid of the default value for the `price` column.

```sql
ALTER TABLE desk
ALTER COLUMN price DROP DEFAULT;
```

## Summary 

Great job. Let's do a quick summary now.

1. To add a default value when defining a table, use:

```sql
CREATE TABLE card_game (
  ...
  min_players integer DEFAULT 2,
  ...
);
```

2. To link a sequence to a table, use:

```sql
CREATE TABLE board_game (
  id integer DEFAULT nextval('my_sequence') PRIMARY KEY
);
```

or when using the standard SQL syntax:

```sql
CREATE TABLE board_game (
  id integer DEFAULT NEXT VALUE FOR my_sequence PRIMARY KEY
);
```

3. To add a default value to an existing column, use:

```sql
ALTER TABLE therapist
ALTER COLUMN price SET DEFAULT 60.00;
```

4. To remove a default value from an existing column, use:

```sql
ALTER TABLE therapist
ALTER COLUMN full_name DROP DEFAULT;
```

How about a pop quiz?

## Quiz

Here's the quiz for you!

### Exercise 1

A rent-a-car company has the following table that stores information about their rental cars:

```sql
CREATE TABLE car (
  id integer PRIMARY KEY,
  make varchar(64) DEFAULT 'Ford',
  model varchar(64),
  displacement decimal(3, 1)
);
```

Your task is to:

1. Add a default value of `1.8` to the `displacement` column.
2. Remove the default value for the `make` column.

```sql
ALTER TABLE car
ALTER COLUMN displacement SET DEFAULT 1.8;

ALTER TABLE car
ALTER COLUMN make DROP DEFAULT;
```

## Congratulations

Perfect! This was the last exercise in this part. Congratulations!

Before we finish the course, there is one more challenge ahead of you: the Final Quiz. Take your time, do a review of everything you've learned so far, and we'll see you there!